---
layout: post
title: (네트워크) NAT와 포트포워딩
tags:
  - 네트워크
---

<br>

> 도커를 사용하면서 NAT와 포트포워딩 개념을 확실히 정리할 필요성을 느꼈다. 
>
> youtube에서  [따라하면서 배우는 IT](https://www.youtube.com/watch?v=Qle5cfCcuEY)  영상을 보면서 간단하게 정리해보았다. 

<br>

### NAT (Network Address Translation)

---

- IP패킷의 TCP/UDP 포트 숫자와 소스및 목적지의 IP주소 등을 <b>재기록</b>하면서 라우터를 통해 네트워크 트래픽을 주고 받는 기술을 말하다.
- 패킷에 변화가 생기기 땜문에 IP나 TCP/UDP의 체크섬도 다시 계산되어 재기록해야 한다.
- NAT을 이용하는 이유는 대개 사설 네트워크에 속한 여러개의 호스트가 하나의 공인 IP 주소를 사용하여 인터넷에 접속하기 위함이다. 
- 하지만 꼭 사설 IP를 공인 IP로 변환하는 데에만 사용하는 기술은 아니다
- 정리) 사설 네트워크에 내부에 있는 IP주소는 globally unique하지 않음. 네트워크로 나갈때 공인 IP주소를 사용한다. 그러면 네트워크로 나가기전에 NAT테이블에 사설IP주소와 포트번호에 매핑되는 공인IP주소와 특정 포트번호를 작성한다. 그러면 돌아올때 이 특정 포트번호로 들어오면 NAT테이블에서 정보를 확인해서 통신한다. 

 <br>

### 포트포워딩

---

- 포트 포워딩 또는 포트 매핑은 패킷이 라우터나 방화벽과 같은 네트워크 장비를 가로지르는 동안 특정 IP주소와 포트번호의 통신 요청을 특정 다른 IP주소와 포트 번호로 넘겨주는 네트워크 주소변환(NAT)의 응용이다.
- 이 기법은 게이트웨이(외부망)의 반대쪽에 위치한 사설네트워크에 상주하는 호스트에 대한 서비스를 생성하기 위해 흔히 사용된다. 
- 정리) 사설네트워크 안에서 서버가 있을 때, 클라이언트에서 먼저 이 서버에 접근하려면 어떻게 해야할까??
  - 먼저, 공인 IP주소,포트번호로 찾아간다
  - 이때 라우터에 포트포워딩 설정을 미리 해둔다 (특정 포트번호로 들어온 요청은 사설네트워크 내부에 특정 IP의 특정 포트로 전송해줘라)
  - 그러면 클라이언트가 먼저 공인 IP주소로 라우터까지 오면, 포트번호를 보고 위 설정을 참고해서 포워딩을 해준다.

<br>

