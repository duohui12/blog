---
layout: post
title: (MSSQL) 인덱스
tags:
  - MSSQL
---

<br>

> 참고 : 이것이 SQL Server다

<br>

### 인덱스

---

- 장점 
  - 검색속도가 빨라질 수 있다 -> 시스템 성능이 향상될 수 있다

- 단점

  - 추가적인 데이터베이스 공간이 필요하다 (책 뒤 찾아보기 페이지)
  - 데이터 변경(Insert, Update, Delete)작업이 일어날때는 오히려 성능이 떨어질 수 있다.

  - 처음 인덱스를 생성하는데 시간이 많이 걸릴 수 있다. 

- 기본키(primary key)로 설정한 열은 자동으로 클러스터형 인덱스가 생성이 된다. 

  - 기본키를 지정하면서 비클러스터형 인덱스로 꼭 만들고 싶을 때는 `usrID char(10) PRIMARY KEY NONCLUSTERED` 이렇게 적어줘야 한다. 

- 인덱스가 만들어지는 제약조건 : `Primary Key`,`Unique`

  - PRIMARY KEY : 기본으로 클러스터형 인덱스가 생성 (테이블당 하나만 만들 수 있음)
  - UNIQUE : 기본으로 비클러스터형 인덱스가 생성 (여러 컬럼에 unique제약조건을 붙일 수 있음)

<br>

### 인덱스의 종류

---

- 클러스터형 인덱스 (Clustered Index)
  - ex) <b>영어사전</b> (영어사전 내용 자체가 정렬되어 있음)
  - 데이터 자체가 정렬이 되어 있다.
  - 테이블당 한개만 만들 수 있다.
  - 인덱스로 지정한 컬럼을 기준으로 정렬이 된다.

<br>

- 비클러스터형 인덱스 (NonClustered Index)
  - ex) <b>책 뒤 찾아보기</b> (책 내용 자체는 정렬되어 있지 않음)
  - 데이터는 정렬되어 있지 않고, 인덱스만 정렬되어 있다.
  - 테이블당 여러개를 만들 수 있다. 

<br>

### 클러스터형 인덱스와 비클러스터형 인덱스의 구조

---

- 클러스터형 인덱스
  - 데이터를 입력하면, 인덱스로 지정한 컬럼을 기준으로 정렬이 된다.
  - 클러스터형 인덱스는 인덱스 자체의 리프 페이지가 곧 데이터다. 인덱스 자체에 데이터가 포함되어 있다고 볼 수 있다. 
  - 비클러스터형보다 검색속도는 더 빠르다. 하지만 데이터의 입력/수정/삭제는 더 느리다
  - Insert문 실행할 때 클러스터형 인덱스의 경우, 데이터 페이지 전체가 다시 정렬된다. 이미 대용량의 데이터가 입력된 상태라면 심각한 시스템 부하를 줄 수도 있다.
  - 테이블에 한 개만 생성할 수 있다. 

![클러스터형인덱스](https://github.com/AmyJJung/blog/blob/main/images/database/clustered.png?raw=true)

<br>

- 비클러스터형 인덱스

  - 데이터를 입력하면, 입력한 순서대로 존재한다.
  - 비클러스터형 인덱스 생성 시에는 데이터 페이지는 변경하지 않고, 별도의 인덱스 페이지를 구성
  - 비클러스터형 인덱스의 리프페이지는 데이터 자체가 아니라, 데이터가 위치하는 포인터(RID)다.
  - 클러스터형 인덱스보다 검색 속도는 느리지만, 데이터의 입력/수정/삭제는 덜 느리다
  - 테이블에 여러개의 비클러스터형 인덱스를 생성할 수 있다. 하지만 남용할 경우 시스템 성능이 떨어질 수 있기 때문에, 꼭 필요한 열에만 생성하자.

  ![비클러스터형인덱스](https://github.com/AmyJJung/blog/blob/main/images/database/nonclustered.png?raw=true)

 <br>

